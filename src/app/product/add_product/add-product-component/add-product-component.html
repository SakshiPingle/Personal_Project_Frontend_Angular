<div class="form-container">
  <mat-card class="form-card">
    @if(mode == 'create'){
    <h2>Create Product</h2>
    } @if(mode == 'edit'){
    <h2>Edit Product</h2>
    }

    <form #AddProductForm="ngForm" (submit)="AddProduct(AddProductForm)" style="margin-bottom: -13px;">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Product Name</mat-label>
        <input
          matInput
          type="text"
          placeholder="Enter product name"
          ngModel
          name="product_name"
          #product_name="ngModel"
          required
          [(ngModel)]="productDetailsForEdit.product_name"
        />
        @if((AddProductForm.submitted && product_name.invalid) || product_name.touched){
        <mat-error> Valid category is required </mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          placeholder="Enter product description"
          ngModel
          name="product_description"
          #product_description="ngModel"
          required
          [(ngModel)]="productDetailsForEdit.product_description"
        ></textarea>
        @if((AddProductForm.submitted && product_description.invalid) ||
        product_description.touched){
        <mat-error> Valid category is required </mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Category</mat-label>
        <mat-select ngModel name="category" #category="ngModel" required [(ngModel)]="productDetailsForEdit.categoryId">
          <mat-option *ngFor="let cat of category_list" [value]="cat.id">
            {{ cat.category_name }}
          </mat-option>
        </mat-select>
        @if((AddProductForm.submitted && category.invalid) || category.touched){
        <mat-error> Category is required </mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Price</mat-label>
        <input
          matInput
          type="number"
          placeholder="Enter product price"
          ngModel
          name="product_price"
          #product_price="ngModel"
          required
          [(ngModel)]="productDetailsForEdit.product_price"
        />
        @if((AddProductForm.submitted && product_price.invalid) || product_price.touched){
        <mat-error> Valid category is required </mat-error>
        }
      </mat-form-field>
      @if(mode == 'create'){
      <button
        [disabled]="AddProductForm.invalid"
        mat-raised-button
        color="accent"
        class="full-width"
      >
        Create Product
      </button>
      } 
      @if(mode == 'edit'){
      <button
        [disabled]="AddProductForm.invalid"
        mat-raised-button
        color="accent"
        class="full-width"
      >
        Edit Product
      </button>
      }
    </form>
    @if(mode == 'create'){
<h3 class="orHtag">OR</h3>
          <!-- file upload -->
      <div class="upload-section">
        <input
          type="file"
          #fileInput
          (change)="onFileSelected($event)"
          accept=".xlsx,.xls"
          hidden
        />
        <button mat-raised-button color="accent" (click)="openFilePicker(fileInput)" style="margin-right: 10px;width: 11.5vw;">
          Choose File
        </button>
        <button mat-raised-button color="primary" (click)="uploadFile()" [disabled]="!selectedFile" style="width: 11.5vw;">
          Upload
        </button>
        <span class="file-name" *ngIf="selectedFile && !message">{{ selectedFile.name }}</span>
          <!-- message -->
       <p class="upload-message">{{ message }}</p>
      </div>
    }
    
  </mat-card>
</div>
